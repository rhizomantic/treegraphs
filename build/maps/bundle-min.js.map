{"version":3,"sources":["main.js","generate.js","spread.js","render.js"],"names":["seed","density","render","canvas","editor","area","tickers","Set","t","go","tweenable","backCol","graphs","def0","props","renderConfig","type","levels","net","num","pos","ang","step","ease","pow","terms","min","max","dur","turn","children","def","stroke","fill","weightMult","weightAdd","mirror","size","weight","dif","var","setup","createCanvas","parent","background","strokeWeight","noFill","smooth","select","mouseClicked","reset","hide","console","log","fromEditor","_def","JSON","parse","value","generateSimple","int","random","randomSeed","noiseSeed","k","Graph","push","stringify","replacer","RenderCurves","key","val","Math","floor","draw","g","root","update","moveNode","makeGroup","gix","dad","graph","group","i","n","Node","ix","nrm","depth","count","anchor","rot","init","j","length","groups","[object Object]","args","this","rnd","windowWidth","windowHeight","curves","tw","isNaN","parseCurve","prop","Object","entries","x","base","time","ti","p","abs","sin","PI","noise","pick","opts","mousePressed","keyTyped","document","activeElement","getElementById","gt","getTime","saveCanvas","generate","style","show","contrast","f","constrain","now","Date","getFullYear","toString","substring","getMonth","padStart","getDate","getHours","getMinutes","getSeconds","generateWithBudget","total","angles","dn","budget","neo","a1","baseNum","close","TWO_PI","width","height","c","out","ts","split","ps","parseFloat","trm","_mirror","cos","drawNode","line","ellipse","kids","df","lv","hasOwnProperty","sizeAdd","sizeMult","renderNode","level","noStroke","bezier","beginShape","a","vertex","nxt","bezierVertex","endShape","CLOSE","sz","nd","hlf","anc","prv","pts","siblings","cou","cs","sn","text"],"mappings":"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","sourcesContent":["var tickers = new Set();\r\nvar t = 0;\r\nvar seed;\r\nvar density;\r\nvar go = true;\r\nvar render;\r\nvar canvas, editor, area;\r\nvar tweenable = [\"step\", \"turn\", \"size\", \"weight\"];\r\nvar backCol = \"#000000\";\r\n\r\n// pi/2 = 1.5707\r\n// pi/3 = 1.047\r\n// pi/4 = 0.7853\r\nvar graphs = [];\r\n\r\nvar def0 = {\r\n    \"props\": {\r\n        \"render\": \"curves\",\r\n        \"renderConfig\": { \"type\": \"petals\", \"levels\": [['#FFCC0088', 8], ['rgba(255, 0, 0, 0.1)', 4]] }\r\n    },\r\n    \"net\": {\r\n        \"type\": \"fan\", \"num\": 35, \"pos\": [ 500, 400 ], \"ang\": 0, \"step\": {\"ease\":\"sine\", \"pow\": -3, \"terms\": \"noise*0.8+t*0.2\", \"min\": 30, \"max\": 480, \"dur\": 200}, \"turn\": 6.28/35, \"children\": [\r\n            //{ \"type\": \"chain\", \"num\": 3,  \"step\": 40, \"turn\": 0.5 }\r\n        ]\r\n    }\r\n};\r\n\r\nvar def = {\r\n  \"props\": {\r\n    \"render\": {\r\n      \"levels\": [\r\n        {\r\n          \"type\": \"tree\",\r\n          \"stroke\": \"#00000088\",\r\n          \"fill\": \"#00000033\",\r\n          \"weightMult\": 0,\r\n          \"weightAdd\": 1\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  \"net\": [\r\n    {\r\n      \"num\": 4,\r\n      \"type\": \"fan\",\r\n      \"mirror\": true,\r\n      \"size\": 72,\r\n      \"weight\": 1,\r\n      \"step\": 300,\r\n      \"turn\": {\r\n        \"min\": 0,\r\n        \"dif\": 3.14,\r\n        \"terms\": \"ix\"\r\n      },\r\n      \"children\": [\r\n        {\r\n          \"num\": 12,\r\n          \"type\": \"fan\",\r\n          \"mirror\": true,\r\n          \"size\": 36,\r\n          \"weight\": 1,\r\n          \"step\": {\r\n            \"min\": 30,\r\n            \"dif\": 150,\r\n            \"terms\": \"tix\",\r\n            \"ease\": \"none\",\r\n            \"pow\": 3,\r\n            \"dur\": 200\r\n          },\r\n          \"turn\": {\r\n            \"min\": 0,\r\n            \"dif\": 3.14,\r\n            \"var\": 1.04,\r\n            \"terms\": \"ix\",\r\n            \"pow\": 2,\r\n            \"dur\": 200\r\n          },\r\n          \"children\": [\r\n            /*{\r\n              \"num\": 24,\r\n              \"type\": \"fan\",\r\n              \"mirror\": true,\r\n              \"size\": 6,\r\n              \"weight\": 1,\r\n              \"step\": {\r\n                \"min\": 100,\r\n                \"dif\": 200,\r\n                \"terms\": \"t*0.5+ix*0.5\",\r\n                \"ease\": \"hill\",\r\n                \"pow\": 3,\r\n                \"dur\": 200\r\n              },\r\n              \"turn\": {\r\n                \"min\": 0,\r\n                \"dif\": 4.85,\r\n                \"terms\": \"ix\"\r\n              },\r\n              \"children\": []\r\n          }*/\r\n          ]\r\n        }\r\n      ],\r\n      \"pos\": [\r\n        702.5,\r\n        479\r\n      ]\r\n    }\r\n  ]\r\n};\r\n\r\n\r\n\r\nfunction setup() {\r\n    canvas = createCanvas(1080, 1080);//(windowWidth, windowHeight);\r\n    canvas.parent('container');\r\n    background(backCol);\r\n    //frameRate(30);\r\n    stroke(0, 128);\r\n    strokeWeight(3);\r\n    //fill(0, 32);\r\n    noFill();\r\n    smooth();\r\n\r\n\r\n\r\n    editor = select(\"#editor\");\r\n    area = select(\"#editor-area\");\r\n    let update = select(\"#update\");\r\n    update.mouseClicked( function(){ reset(true) } );\r\n    let generate = select(\"#generate\");\r\n    generate.mouseClicked( function(){ reset(false) } );\r\n\r\n    editor.hide();\r\n\r\n    reset( false );\r\n\r\n    console.log(\"setup\");\r\n}\r\n\r\nfunction reset(fromEditor) {\r\n  //let area = select(\"#editor-area\");\r\n  let _def;\r\n  if(fromEditor) {\r\n      _def = JSON.parse(area.value());\r\n  } else {\r\n      _def = generateSimple();\r\n  }\r\n  //tickers.clear();\r\n  background(backCol);\r\n  t = 0;\r\n  seed = int(random(999999));\r\n  randomSeed(seed);\r\n  noiseSeed(seed);\r\n\r\n  graphs = [];\r\n  //let _def = generate();\r\n  var k = new Graph( _def );\r\n  graphs.push(k);\r\n\r\n  area.value( JSON.stringify(_def, replacer, 2) );\r\n\r\n  render = new RenderCurves(_def);\r\n\r\n}\r\n\r\nfunction replacer(key, val) {\r\n    if(typeof(val) == \"number\") return Math.floor(val*100)/100;\r\n    return val;\r\n}\r\n\r\n\r\n\r\nfunction draw() {\r\n  if(go) {\r\n      background(backCol);\r\n      for(let g of graphs) {\r\n          g.root.update();\r\n          moveNode(g.root);\r\n          render.render(g.root);\r\n      }\r\n\r\n      t++;\r\n\r\n      //if(t == 200) reset();\r\n  }\r\n}\r\n\r\nfunction makeGroup(gix, g, dad, graph) {\r\n    //console.log(\"makeGroup\", g);\r\n    let group = [];\r\n    for(let i=0; i<g.num; i++) {\r\n        let n = new Node();\r\n        group.push(n);\r\n        n.ix = i;\r\n        n.gix = gix;\r\n        n.nrm = g.num == 1 ? 0 : (1 / (g.num)) * i;\r\n        n.parent = dad;\r\n        //n.parent.kids.push(n);\r\n        n.depth = dad.depth+1;\r\n        n.graph = graph;\r\n\r\n        graph.count ++;\r\n        graph.depth = Math.max(graph.depth, n.depth);\r\n        //console.log(n);\r\n\r\n        if(g.type == \"chain\" && i > 0) {\r\n            n.anchor = group[i-1];// dad.kids[i-1];\r\n        } else {\r\n            n.anchor = dad;\r\n        }\r\n\r\n        //n.turn = isNaN(g.turn) ? parseCurve(g.turn, n) : g.turn;// n.parent.turn + g.turn * n.ix;\r\n        //n.step = isNaN(g.step) ? parseCurve(g.step, n) : g.step;\r\n        n.type = g.type;\r\n        n.rot = 0;\r\n        n.turn = g.turn;\r\n        n.step = g.step;\r\n        n.mirror = g.mirror;\r\n        n.size = g.size;\r\n        n.weight = g.weight;\r\n        n.fill = g.fill;\r\n        n.stroke = g.stroke;\r\n\r\n        n.init();\r\n\r\n        if(g.children) {\r\n            for(let j=0; j<g.children.length; j++) {\r\n                makeGroup(j, g.children[j], n, graph);\r\n            }\r\n        }\r\n    }\r\n\r\n    dad.groups.push(group);\r\n\r\n}\r\n\r\n\r\n/***** GRAPH *****/\r\nclass Graph {\r\n  constructor(args = {}) {\r\n    this.ix = graphs.length;\r\n    this.count = 0;\r\n    this.depth = 0;\r\n\r\n    this.root = new Node( {pos: args.net[0].pos} );\r\n    for(let i=0; i<args.net.length; i++){\r\n        makeGroup(i, args.net[i], this.root, this);\r\n    }\r\n    this.root.init();\r\n\r\n    console.log(\"graph\", this);\r\n  }\r\n}\r\n\r\n/***** NODE *****/\r\nclass Node {\r\n    constructor(args = {}) {\r\n        //properties\r\n        this.ix = args.ix || 0;\r\n        this.gix = args.gix || 0;\r\n        this.nrm = args.nrm || 0;\r\n        this.rnd = args.rnd || Math.random();\r\n        this.pos = args.pos || [windowWidth / 2, windowHeight / 2];\r\n        this.step = args.step || 30;\r\n        this.turn = args.turn || 0;\r\n        this.rot = args.rot || 0;\r\n        this.mirror = args.mirror || false;\r\n        this.size = args.size || 20;\r\n        this.weight = args.weight || 1;\r\n        this.depth = args.depth || 0;\r\n        this.fill = args.fill || \"#888888\";\r\n        this.stroke = args.stroke || 0;\r\n\r\n        // Node references\r\n        this.graph = args.graph || null;\r\n        this.parent = args.parent || null;\r\n        this.anchor = args.anchor || null;\r\n        //this.kids = args.kids || [];\r\n        this.groups = args.groups || [];\r\n\r\n        this.curves = {};\r\n\r\n    }\r\n\r\n    init() {\r\n        for (let tw of tweenable) {\r\n            if (isNaN(this[tw])) {\r\n                this.curves[tw] = parseCurve(this[tw], this);\r\n            }\r\n        }\r\n\r\n        /*for(let k of this.kids) {\r\n            k.init();\r\n        }*/\r\n        for(let g of this.groups) {\r\n            for(let k of g) {\r\n                k.init();\r\n            }\r\n        }\r\n    }\r\n\r\n    update() {\r\n        for(let [prop, val] of Object.entries(this.curves)) {\r\n            let x = val.base;\r\n            //if(val.dur > 0) x += (1 / val.dur) * (t % (val.dur+1)) * val.time;\r\n            if(val.dur > 0 && val.time > 0) { // come and go\r\n                let ti = floor(t / (val.dur+1)) % 2 == 0 ? t % (val.dur+1) : (val.dur+1) - (t % (val.dur+1));\r\n                x += (1 / val.dur) * ti + val.time;\r\n            }\r\n            //if(x > 1) x %= 1;\r\n            if(x > 1) x = floor(x%2) == 0 ? x%1 : 1 - (x%1);\r\n            //if(prop == \"turn\") console.log(this.ix, x);\r\n\r\n\r\n            this[prop] = val.min + ease(val.ease, x, val.pow) * val.dif;\r\n            //this[prop] = val.min + ease(val.ease, x, val.pow) * val.var * this.ix;\r\n        }\r\n\r\n        /*for(let k of this.kids) {\r\n            k.update();\r\n        }*/\r\n        for(let g of this.groups) {\r\n            for(let k of g) {\r\n                k.update();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction ease(type, x, p) {\r\n    if(type == \"simple\") {\r\n        return p < 0 ? 1 - Math.pow(1-x, Math.abs(p)) : Math.pow(x, Math.abs(p));\r\n    } else if (type == \"IO\") {\r\n        //if(t < 0.5) return easeSimple(t*2, p) * 0.5;\r\n        //else return (1 - easeSimple(1-(t-0.5)*2, p)) * 0.5 + 0.5;\r\n        if(x < 0.5) return (p < 0 ? 1 - Math.pow(1-x*2, Math.abs(p)) : Math.pow(x*2, Math.abs(p))) * 0.5;\r\n        else return (1 - (p < 0 ? 1 - Math.pow(1-(1-(x-0.5)*2), Math.abs(p)) : Math.pow(1-(x-0.5)*2, Math.abs(p)))) * 0.5 + 0.5;\r\n    } else if (type == \"hill\") {\r\n        x = x < 0.5 ? x * 2 : 1 - (x-0.5)*2;\r\n        return p < 0 ? 1 - Math.pow(1-x, Math.abs(p)) : Math.pow(x, Math.abs(p));\r\n    } else if (type == \"sine\") {\r\n        return Math.sin(x*p*Math.PI*2) * 0.5 + 0.5;\r\n    } else if (type == \"noise\") {\r\n        return noise(x*16);\r\n    } else {\r\n        return x;\r\n    }\r\n\r\n}\r\n\r\nfunction pick(...opts) {\r\n    return opts[floor(random(opts.length))];\r\n}\r\n\r\n\r\nfunction mousePressed() {\r\n  //pen.set(mouseX, mouseY);\r\n}\r\n\r\nfunction keyTyped() {\r\n    if (document.activeElement === document.getElementById('editor-area')) return;\r\n\r\n    if (key === ' ') {\r\n        go = !go;\r\n        console.log(\"go\", go);\r\n    } else if (key === 'r') {\r\n        reset(false);\r\n    } else if (key === 's') {\r\n        let gt = getTime();\r\n        saveCanvas(\"TG-\" + gt + \".jpg\");\r\n        //saveJSON(defs, \"TG-\" + gt + \".jpg\", false);\r\n    } else if (key === 'g') {\r\n        generate();\r\n    } else if (key === 'e') {\r\n        if (editor.style(\"display\") == \"block\") editor.hide();\r\n        else editor.show();\r\n    }\r\n    // uncomment to prevent any default behavior\r\n    //return false;\r\n}\r\n\r\nfunction contrast(n, f) {\r\n  return constrain(f*(n-0.5) + 0.5, 0, 1);\r\n}\r\n\r\nfunction getTime() {\r\n  let now = new Date();\r\n  return now.getFullYear().toString().substring(2,4) +\r\n        (now.getMonth() + 1).toString().padStart(2, \"0\") +\r\n        (now.getDate()).toString().padStart(2, \"0\") + \"-\" +\r\n        (now.getHours()).toString().padStart(2, \"0\") +\r\n        (now.getMinutes()).toString().padStart(2, \"0\") +\r\n        (now.getSeconds()).toString().padStart(2, \"0\");\r\n}\r\n\r\n/*function windowResized() {\r\n  resizeCanvas(windowWidth, windowHeight);\r\n  canvas.parent('container');\r\n  background(\"#FFFFFF\");\r\n}*/\r\n","function generateWithBudget() {\r\n    let budget = 200;\r\n    let total = 0;\r\n    let angles = [PI/2, PI, PI*2];\r\n    let def = {\r\n        props:{\r\n            render: { levels: [\r\n                {type:\"tree\", stroke: '#999999', weightMult:0, weightAdd:1 },\r\n                {type:\"bezier\", stroke: '#00000088', weightAdd:4 },\r\n                {type:\"bezier\", stroke:'#FFFFFF88', weight:0} ]\r\n            }\r\n            //\"renderConfig\": { \"type\": \"tree\", \"levels\": [[0, 8], ['#FFFFFF', 4]] }\r\n        },\r\n        net:[]\r\n    };\r\n    let dad = def.net;\r\n    let dn = 1;\r\n\r\n    while(total < budget*0.8) {\r\n        let num = Math.floor( Math.pow(Math.random(), 2) * 10 ) + 2;\r\n        while(total + dn*num > budget && num > 1) {\r\n            num --;\r\n            //console.log(num, dn, total);\r\n        }\r\n        let neo = {\r\n            num: num,\r\n            type: Math.random() < 0.6 ? \"fan\" : \"chain\",\r\n            step: { min:Math.random() * 120 + 30, dif:0 },\r\n            turn: { min:PI/2, dif:angles[Math.floor(random(angles.length))] },\r\n            mirror: num % 2 == 0,\r\n            weight: { min:2, dif:2, terms:\"depth\" },\r\n            size: { min:10, dif:40, terms:\"depth\" },\r\n            children:[]\r\n        };\r\n        dad.push(neo);\r\n        total += dn * num;\r\n\r\n        if(Math.random() < 0.7) {\r\n            //console.log(\"child\", num, dn, total);\r\n            dad = neo.children;\r\n            dn *= num;\r\n\r\n        } else {\r\n            //console.log(\"sibling\", num, dn, total);\r\n        }\r\n    }\r\n\r\n    def.net[0].pos = [windowWidth/2, windowHeight/2];\r\n\r\n    //console.log(total, def);\r\n    return def;\r\n}\r\n\r\nfunction generateSimple() {\r\n    let a1 = random(0.1, PI/2);//PI/2;\r\n    let baseNum = int(random(2,6));\r\n    let def = {\r\n    props:{\r\n        render: { levels: [\r\n            {type:\"squares\", close:true, stroke: '#FFCC0099', fill: '#33333388', weightMult:0, weightAdd:1 },\r\n            {type:\"circles\", stroke: '#FFFFFF88', fill: '#66666688'}\r\n        ] }\r\n    },\r\n    net:[\r\n            {\r\n                num:baseNum,\r\n                type:\"fan\",\r\n                mirror:true,\r\n                size: 72,\r\n                weight: 0,\r\n                step: 120,\r\n                //turn:{ min:PI/2+a1, dif:-a1*4, terms:\"ix\" },\r\n                turn:{ min:0, dif:TWO_PI, terms:\"ix\" },\r\n                children:[\r\n                    {\r\n                        num:baseNum,\r\n                        type:\"fan\",\r\n                        mirror:baseNum%2 == 0 ? random(1) < 0.5 : false,\r\n                        size: 36,\r\n                        weight: 8,\r\n                        step:{ min:180, dif:0, terms:\"ix\", ease:\"none\", pow:1 },\r\n                        turn:{ min:0, dif:random(2, TWO_PI), terms:\"ix\", ease:\"none\", pow:2 },\r\n                        //turn:{ min:0, dif:TWO_PI, terms:\"ix\" },\r\n                        children:[\r\n                            {\r\n                                num:int(24/baseNum),\r\n                                type:\"fan\",\r\n                                mirror:false,\r\n                                size: 26,\r\n                                weight: 4,\r\n                                step:{ min:60, dif:180, terms:\"ix*\"+pick(1,2,3,4), ease:\"hill\", pow:random(-4, 4)},\r\n                                turn:{ min:0, dif:pick(1.78, 3.14, 6.28, 8), terms:\"ix\" },\r\n                                //turn:{ min:0, dif:TWO_PI, terms:\"ix\" },\r\n                                children:[\r\n\r\n                                ]\r\n                            },\r\n                            {\r\n                                num:int(18/baseNum),\r\n                                type:\"fan\",\r\n                                mirror:false,\r\n                                size: 16,\r\n                                weight: 4,\r\n                                step:{ min:60, dif:0, terms:\"ix*\"+pick(1,2,3,4), ease:\"hill\", pow:random(-4, 4)},\r\n                                turn:{ min:0, dif:pick(1.78, 3.14, 6.28, 8), terms:\"ix\" },\r\n                                //turn:{ min:0, dif:TWO_PI, terms:\"ix\" },\r\n                                children:[\r\n\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n\r\n    console.log(\"GEN\", a1, PI/2+a1, -a1*4 );\r\n\r\n    def.net[0].pos = [width/2, height/2];\r\n    console.log(width, height);\r\n    return def;\r\n\r\n}\r\n","function parseCurve(c, n) {\r\n    c.terms = c.terms || \"ix\";\r\n\r\n    let out = {};\r\n    out.ease = c.ease || \"none\";\r\n    out.pow = c.pow || 2;\r\n    out.min = c.min || 0;\r\n    //out.max = c.max || 1;\r\n    out.dif = c.dif || 0;\r\n    //out.var = c.var || c.dif / n.parent.kids.length;\r\n    out.dur = c.dur || 0;\r\n\r\n    out.base = 0;\r\n    out.time = 0;\r\n\r\n    let ts = c.terms.split('+')\r\n    for(let t of ts) {\r\n        let ps = t.split('*');\r\n        if(ps[0] == 't' || ps[0] == 'time') {\r\n            out.time = ps.length > 1 ? parseFloat(ps[1]) : 1;\r\n        } else if(ps[0] == 'tix') {\r\n            out.time = ps.length > 1 ? n.nrm * parseFloat(ps[1]) : n.nrm;\r\n        } else {\r\n            let trm = 1;\r\n            for(let p of ps) {\r\n                if(p == \"ix\") trm *= n.nrm;\r\n                else if(p == \"rnd\") trm *= n.rnd;\r\n                else if(p == \"noise\") trm *= noise(n.parent.nrm, n.nrm);\r\n                else if(p == \"dix\") trm *= n.parent.nrm;\r\n                else if(p == \"drnd\") trm *= n.parent.rnd;\r\n                else if(p == \"depth\") trm *= n.depth;\r\n                else if(p == \"idepth\") trm *= n.graph.depth - n.depth;\r\n                else if(p == \"depth-nrm\") trm *= 1/n.graph.depth * n.depth;\r\n                else if(p == \"idepth-nrm\") trm *= 1 - 1/n.graph.depth * n.depth;\r\n                else trm *= parseFloat(p);\r\n            }\r\n            out.base += trm;\r\n        }\r\n    }\r\n    //console.log(\"curve\", n.graph.depth, n.depth, (n.graph.depth == 1 ? 0 : 1/n.graph.depth * n.depth) );\r\n\r\n    return out;\r\n}\r\n\r\nfunction moveNode(n) {\r\n    if(n.anchor !== null) {\r\n        //let trn = n.parent.rot + n.turn;\r\n\r\n        let _mirror = (n.parent.anchor != null && n.parent.mirror && n.parent.anchor.ix%2 == 0) ^ ( n.mirror && n.parent.ix%2 == 0);\r\n\r\n        n.rot = _mirror? n.parent.rot - n.turn : n.parent.rot + n.turn;\r\n\r\n        n.pos = [\r\n            n.anchor.pos[0] + n.step * cos(n.rot),\r\n            n.anchor.pos[1] + n.step * sin(n.rot)\r\n        ]\r\n\r\n        //if(t == 5) console.log(n.depth, n.ix, n.step, n.rot);\r\n    }\r\n\r\n    /*for(let k of n.kids) {\r\n        moveNode(k);\r\n    }*/\r\n    for(let g of n.groups) {\r\n        for(let k of g) {\r\n            moveNode(k);\r\n        }\r\n    }\r\n}\r\n\r\n/*function moveNode(n) {\r\n    if(n.anchor !== null) {\r\n        let trn;\r\n        if(isNaN(n.turn)) {\r\n            let x = n.turn.base;\r\n            if(n.turn.dur > 0) x += (1 / n.turn.dur) * (t % (n.turn.dur+1)) * n.turn.time;\r\n            x %= 1;\r\n            trn = n.parent.rot + (n.turn.min + ease(n.turn.ease, x, n.turn.pow) * n.turn.dif);\r\n            //if(n.parent.ix == 1) console.log(n.ix, n.parent.rot, n.turn.min, n.turn.ease, n.turn.pow, n.turn.dif);\r\n        } else {\r\n            trn = n.parent.rot + n.turn * n.ix;\r\n        }\r\n        let _mirror = int(n.parent.anchor != null && n.parent.mirror && n.parent.anchor.ix%2 == 0) ^ int( n.mirror && n.parent.ix%2 == 0);\r\n\r\n        n.rot = _mirror? n.parent.rot - trn : n.parent.rot + trn;\r\n        //n.rot %= (Math.PI*2);\r\n\r\n        let stp;\r\n        if(isNaN(n.step)) {\r\n            let x = n.step.base;\r\n            if(n.step.dur > 0) x += (1 / n.step.dur) * (t % (n.step.dur+1)) * n.step.time;\r\n            x %= 1;\r\n            stp = n.step.min + ease(n.step.ease, x, n.step.pow) * n.step.dif;\r\n            //if(n.parent.ix == 1) console.log(n.ix, stp, n.step.dif);\r\n        } else {\r\n            stp = n.step;\r\n        }\r\n        //console.log(n.ix, (0.999 / n.step.dur) * (t % (n.step.dur+1)) * n.step.time);\r\n\r\n        n.pos = [\r\n            n.anchor.pos[0] + stp * cos(n.rot),\r\n            n.anchor.pos[1] + stp * sin(n.rot)\r\n        ]\r\n    }\r\n\r\n    for(let k of n.kids) {\r\n        moveNode(k);\r\n    }\r\n}*/\r\n","\r\nfunction drawNode(n) {\r\n    if(n.anchor != null) line(n.anchor.pos[0], n.anchor.pos[1], n.pos[0], n.pos[1]);\r\n    ellipse(n.pos[0], n.pos[1], 10, 10);\r\n\r\n    for(let k of n.kids) {\r\n        drawNode(k);\r\n    }\r\n}\r\n\r\nclass RenderCurves {\r\n    constructor(df = {}) {\r\n        let args = df.props.render || {};\r\n\r\n        this.type= args.type || \"tree\";\r\n        this.levels = args.levels || [{stroke:0, weight:1}];\r\n        for(let lv of this.levels) {\r\n            if(! lv.hasOwnProperty(\"type\")) lv.type = this.type;\r\n            if(! lv.hasOwnProperty(\"close\")) lv.close = false;\r\n            if(! lv.hasOwnProperty(\"stroke\")) lv.stroke = 0;\r\n            if(! lv.hasOwnProperty(\"fill\")) lv.fill = \"#888888\";\r\n            if(! lv.hasOwnProperty(\"weightAdd\")) lv.weightAdd = 0;\r\n            if(! lv.hasOwnProperty(\"weightMult\")) lv.weightMult = 1;\r\n            if(! lv.hasOwnProperty(\"sizeAdd\")) lv.sizeAdd = 0;\r\n            if(! lv.hasOwnProperty(\"sizeMult\")) lv.sizeMult = 1;\r\n        }\r\n\r\n        //console.log(\"render type\", this.type);\r\n    }\r\n\r\n    render(n) {\r\n        for(let lv of this.levels) {\r\n            //stroke( lv[0] );\r\n            //strokeWeight( lv[1] || 1 );\r\n            //strokeWeight( (n.depth) * lv[1]);\r\n            //console.log(n.depth, lv[1]);\r\n            //fill(192);\r\n            this.renderNode(n, lv);\r\n        }\r\n    }\r\n\r\n    renderNode(n, level) {\r\n\r\n        noFill();\r\n        noStroke();\r\n\r\n        if(level.type== \"bezier\" && level.close == false) {\r\n            for(let g of n.groups) {\r\n                if(g.length > 2) {\r\n                    for(let k=1; k<g.length-1; k++) {\r\n                        let ps = [\r\n                            g[k-1].pos[0] + (g[k].pos[0] - g[k-1].pos[0]) / 2,\r\n                            g[k-1].pos[1] + (g[k].pos[1] - g[k-1].pos[1]) / 2,\r\n                            g[k].pos[0],\r\n                            g[k].pos[1],\r\n                            g[k].pos[0] + (g[k+1].pos[0] - g[k].pos[0]) / 2,\r\n                            g[k].pos[1] + (g[k+1].pos[1] - g[k].pos[1]) / 2\r\n                        ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        bezier(ps[0], ps[1], ps[2], ps[3], ps[2], ps[3], ps[4], ps[5]);\r\n                    }\r\n                }\r\n            }\r\n        } else if(level.type== \"bezier\" && level.close == true) {\r\n\r\n            for(let g of n.groups) {\r\n                if(g.length > 2) {\r\n                    fill(level.fill);\r\n                    beginShape();\r\n                    let a = [ g[0].pos[0] + (g[g.length-1].pos[0] - g[0].pos[0]) / 2, g[0].pos[1] + (g[g.length-1].pos[1] - g[0].pos[1]) / 2 ];\r\n                    vertex( a[0], a[1] );\r\n                    for(let k=0; k<g.length; k++) {\r\n                        let nxt = k==g.length-1 ? 0 : k+1;\r\n                        let ps = [ g[k].pos[0] + (g[nxt].pos[0] - g[k].pos[0]) / 2, g[k].pos[1] + (g[nxt].pos[1] - g[k].pos[1]) / 2 ];\r\n                        fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        bezierVertex(g[k].pos[0], g[k].pos[1], g[k].pos[0], g[k].pos[1], ps[0], ps[1]);\r\n                    }\r\n                    //bezierVertex(g[g.length-1].pos[0], g[g.length-1].pos[1], g[g.length-1].pos[0], g[g.length-1].pos[1], a[0], a[1]);\r\n                    endShape();\r\n                }\r\n            }\r\n        } else if(level.type== \"polygon\") {\r\n            // for(let g of n.groups) {\r\n            //     fill(level.fill);\r\n            //     if(g.length > 1) {\r\n            //         for(let k=1; k<g.length; k++) {\r\n            //             stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n            //             strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n            //             line(g[k-1].pos[0], g[k-1].pos[1], g[k].pos[0], g[k].pos[1]);\r\n            //         }\r\n            //     }\r\n            // }\r\n            for(let g of n.groups) {\r\n                if(g.length > 1) {\r\n                    fill(level.fill);\r\n                    beginShape();\r\n                    for(let k=0; k<g.length; k++) {\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        vertex(g[k].pos[0], g[k].pos[1]);\r\n                    }\r\n                    if(level.close) endShape(CLOSE);\r\n                    else endShape();\r\n                    //endShape();\r\n                }\r\n            }\r\n        } else if(level.type== \"tree\") {\r\n            for(let g of n.groups) {\r\n                for(let k=0; k<g.length; k++) {\r\n                    stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                    strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                    line(g[k].anchor.pos[0], g[k].anchor.pos[1], g[k].pos[0], g[k].pos[1]);\r\n                    //if(t == 6) console.log(k, n.pos[0], n.pos[1], n.kids[k].pos[0], n.kids[k].pos[1]);\r\n                }\r\n            }\r\n        } else if(level.type== \"circles\") {\r\n            for(let g of n.groups) {\r\n                for(let k=0; k<g.length; k++) {\r\n                    let sz = g[k].size * level.sizeMult + level.sizeAdd;\r\n                    fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                    stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                    strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                    ellipse( g[k].pos[0], g[k].pos[1], sz, sz);\r\n                }\r\n            }\r\n        }  else if(level.type== \"star\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 1) {\r\n                    fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                    beginShape();\r\n                    vertex(g[0].pos[0], g[0].pos[1]);\r\n                    for(let k=1; k<(level.close?g.length+1:g.length); k++) {\r\n                        let nd = g[k%g.length];\r\n                        stroke(level.stroke == \"node\" ? nd.stroke : level.stroke);\r\n                        strokeWeight( nd.weight * level.weightMult + level.weightAdd );\r\n                        bezierVertex(n.pos[0], n.pos[1], n.pos[0], n.pos[1], nd.pos[0], nd.pos[1]);\r\n                    }\r\n                    endShape();\r\n                }\r\n            }\r\n        } else if(level.type== \"umbrella\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 1) {\r\n                    fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                    beginShape();\r\n                    vertex(g[0].pos[0], g[0].pos[1]);\r\n                    for(let k=0; k<(level.close?g.length:g.length-1); k++) {\r\n                        let nxt = g[(k+1) % g.length];\r\n                        let hlf = [ (nxt.pos[0] - g[k].pos[0]) / 2, (nxt.pos[1] - g[k].pos[1]) / 2 ];\r\n                        let anc = [ (g[k].pos[0] + hlf[0]) - hlf[1], (g[k].pos[1] + hlf[1]) + hlf[0] ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        bezierVertex(anc[0], anc[1], anc[0], anc[1], nxt.pos[0], nxt.pos[1]);\r\n                    }\r\n                    endShape();\r\n                }\r\n            }\r\n        } else if(level.type== \"snake\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 1) {\r\n                    fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                    beginShape();\r\n                    vertex(g[0].pos[0], g[0].pos[1]);\r\n                    for(let k=0; k<(level.close?g.length:g.length-1); k++) {\r\n                        let nxt = g[(k+1) % g.length];\r\n                        let hlf = [ (nxt.pos[0] - g[k].pos[0]) / 2, (nxt.pos[1] - g[k].pos[1]) / 2 ];\r\n                        let anc = [\r\n                            (g[k].pos[0] + hlf[0]) - hlf[1], (g[k].pos[1] + hlf[1]) + hlf[0],\r\n                            (g[k].pos[0] + hlf[0]) + hlf[1], (g[k].pos[1] + hlf[1]) - hlf[0]\r\n                        ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        bezierVertex(anc[0], anc[1], anc[2], anc[3], nxt.pos[0], nxt.pos[1]);\r\n                    }\r\n                    endShape();\r\n                }\r\n            }\r\n        }  else if(level.type== \"petals\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 2) {\r\n                    for(let k=(level.close?0:1); k<g.length; k++) {\r\n                        let prv = g[k==0 ? g.length-1 : k-1];\r\n                        let hlf = [ (prv.pos[0] - g[k].pos[0]) / 2, (prv.pos[1] - g[k].pos[1]) / 2 ];\r\n                        let pts = [\r\n                            (g[k].pos[0] + hlf[0]) - hlf[1], (g[k].pos[1] + hlf[1]) + hlf[0],\r\n                            (g[k].pos[0] + hlf[0]) + hlf[1], (g[k].pos[1] + hlf[1]) - hlf[0]\r\n                        ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                        // bezier(pts[0], pts[1], prv.pos[0], prv.pos[1], prv.pos[0], prv.pos[1], pts[2], pts[3]);\r\n                        // bezier(pts[0], pts[1], g[k].pos[0], g[k].pos[1], g[k].pos[0], g[k].pos[1], pts[2], pts[3]);\r\n                        beginShape();\r\n                        vertex(g[k].pos[0], g[k].pos[1]);\r\n                        vertex(pts[0], pts[1]);\r\n                        vertex(prv.pos[0], prv.pos[1]);\r\n                        vertex(pts[2], pts[3]);\r\n                        vertex(g[k].pos[0], g[k].pos[1]);\r\n                        endShape();\r\n                    }\r\n                }\r\n            }\r\n        }  else if(level.type== \"petal-chain\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 2) {\r\n                    for(let k=(level.close?0:1); k<g.length; k++) {\r\n                        let prv = g[k==0 ? g.length-1 : k-1];\r\n                        let hlf = [ (prv.pos[0] - g[k].pos[0]) / 2, (prv.pos[1] - g[k].pos[1]) / 2 ];\r\n                        let pts = [\r\n                            (g[k].pos[0] + hlf[0]) - hlf[1], (g[k].pos[1] + hlf[1]) + hlf[0],\r\n                            (g[k].pos[0] + hlf[0]) + hlf[1], (g[k].pos[1] + hlf[1]) - hlf[0]\r\n                        ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                        bezier(prv.pos[0], prv.pos[1], pts[0], pts[1], pts[0], pts[1], g[k].pos[0], g[k].pos[1]);\r\n                        bezier(g[k].pos[0], g[k].pos[1], pts[2], pts[3], pts[2], pts[3], prv.pos[0], prv.pos[1]);\r\n                    }\r\n                }\r\n            }\r\n        }  else if(level.type== \"square-chain\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 2) {\r\n                    for(let k=(level.close?0:1); k<g.length; k++) {\r\n                        let prv = g[k==0 ? g.length-1 : k-1];\r\n                        let hlf = [ (prv.pos[0] - g[k].pos[0]) / 2, (prv.pos[1] - g[k].pos[1]) / 2 ];\r\n                        let pts = [\r\n                            (g[k].pos[0] + hlf[0]) - hlf[1], (g[k].pos[1] + hlf[1]) + hlf[0],\r\n                            (g[k].pos[0] + hlf[0]) + hlf[1], (g[k].pos[1] + hlf[1]) - hlf[0]\r\n                        ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                        beginShape();\r\n                        vertex(g[k].pos[0], g[k].pos[1]);\r\n                        vertex(pts[0], pts[1]);\r\n                        vertex(prv.pos[0], prv.pos[1]);\r\n                        vertex(pts[2], pts[3]);\r\n                        vertex(g[k].pos[0], g[k].pos[1]);\r\n                        endShape();\r\n                    }\r\n                }\r\n            }\r\n        }  else if(level.type== \"daisy\") {\r\n            for(let g of n.groups) {\r\n                if(g.length > 2) {\r\n                    for(let k=(level.close?0:1); k<(level.close?g.length:g.length-1); k++) {\r\n                        let prv = g[k==0 ? g.length-1 : k-1];\r\n                        let nxt = g[(k+1) % g.length];\r\n                        let pts = [\r\n                            g[k].pos[0] + (prv.pos[0] - g[k].pos[0]) / 2, g[k].pos[1] + (prv.pos[1] - g[k].pos[1]) / 2,\r\n                            g[k].pos[0] + (nxt.pos[0] - g[k].pos[0]) / 2, g[k].pos[1] + (nxt.pos[1] - g[k].pos[1]) / 2\r\n                        ];\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                        bezier(n.pos[0], n.pos[1], pts[0], pts[1], pts[0], pts[1], g[k].pos[0], g[k].pos[1]);\r\n                        bezier(n.pos[0], n.pos[1], pts[2], pts[3], pts[2], pts[3], g[k].pos[0], g[k].pos[1]);\r\n\r\n                    }\r\n                }\r\n            }\r\n        } else if(level.type== \"cousins\") {\r\n            if(n.depth > 1){\r\n                for(let g of n.groups) {\r\n                    for(let k=0; k<g.length; k++) {\r\n                        let siblings = n.parent.groups[n.gix];\r\n                        //console.log(siblings);\r\n                        let bro = siblings[(n.ix+1)%siblings.length];\r\n                        let cou = bro.groups[g[k].gix][g[k].ix];\r\n\r\n                        stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                        strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                        //line(g[k].pos[0], g[k].pos[1], cou.pos[0], cou.pos[1]);\r\n                        //bezier(g[k].pos[0], g[k].pos[1], g[k].anchor.pos[0], g[k].anchor.pos[1], cou.anchor.pos[0], cou.anchor.pos[1], cou.pos[0], cou.pos[1]);\r\n                        bezier(g[k].anchor.pos[0], g[k].anchor.pos[1], g[k].pos[0], g[k].pos[1], cou.pos[0], cou.pos[1], cou.anchor.pos[0], cou.anchor.pos[1]);\r\n\r\n                    }\r\n                }\r\n            }\r\n        } else if(level.type== \"squares\") {\r\n            for(let g of n.groups) {\r\n                for(let k=0; k<g.length; k++) {\r\n                    let sz = g[k].size * level.sizeMult + level.sizeAdd;\r\n                    let cs = cos(g[k].rot), sn = sin(g[k].rot);\r\n                    let pts = [\r\n                        g[k].pos[0]+sz*cs, g[k].pos[1]+sz*sn,\r\n                        g[k].pos[0]-sz*sn, g[k].pos[1]+sz*cs,\r\n                        g[k].pos[0]-sz*cs, g[k].pos[1]-sz*sn,\r\n                        g[k].pos[0]+sz*sn, g[k].pos[1]-sz*cs\r\n\r\n\r\n                    ]\r\n                    fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                    stroke(level.stroke == \"node\" ? g[k].stroke : level.stroke);\r\n                    strokeWeight( g[k].weight * level.weightMult + level.weightAdd );\r\n                    beginShape();\r\n                    vertex(g[k].pos[0], g[k].pos[1]);\r\n                    vertex(pts[0], pts[1]);\r\n                    vertex(pts[2], pts[3]);\r\n                    vertex(pts[4], pts[5]);\r\n                    vertex(pts[6], pts[7]);\r\n                    vertex(pts[0], pts[1]);\r\n                    endShape();\r\n                }\r\n            }\r\n        } else if(level.type== \"debug\") {\r\n            for(let g of n.groups) {\r\n                for(let k=0; k<g.length; k++) {\r\n                    fill(level.fill == \"node\" ? g[k].fill : level.fill);\r\n                    text(\"ix\"+g[k].ix+\" gid\"+g[k].gix, g[k].pos[0], g[k].pos[1]);\r\n\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n        /*for(let k of n.kids) {\r\n            this.renderNode(k, level);\r\n        }*/\r\n        for(let g of n.groups) {\r\n            for(let k of g) {\r\n                this.renderNode(k, level);\r\n            }\r\n        }\r\n    }\r\n}\r\n"],"file":"../bundle-min.js"}